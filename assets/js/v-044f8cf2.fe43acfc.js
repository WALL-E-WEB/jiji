"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[503],{8854:(s,n,a)=>{a.r(n),a.d(n,{data:()=>e});const e={key:"v-044f8cf2",path:"/study/18.Jest/jest.html",title:"jest",lang:"en-US",frontmatter:{},excerpt:"",headers:[{level:2,title:"vue-jest",slug:"vue-jest",children:[]},{level:2,title:"sion",slug:"sion",children:[]},{level:2,title:"模拟http",slug:"模拟http",children:[]}],filePathRelative:"study/18.Jest/jest.md",git:{updatedTime:1643448789e3}}},5431:(s,n,a)=>{a.r(n),a.d(n,{default:()=>t});const e=(0,a(6252).uE)('<h1 id="jest" tabindex="-1"><a class="header-anchor" href="#jest" aria-hidden="true">#</a> jest</h1><p>参考</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>http://www.likecs.com/show-90674.html\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="vue-jest" tabindex="-1"><a class="header-anchor" href="#vue-jest" aria-hidden="true">#</a> vue-jest</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>https://vue-test-utils.vuejs.org/zh/guides/#%E8%B5%B7%E6%AD%A5\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>加入<span class="token operator">:</span>jest\nvue add @vue<span class="token operator">/</span>cli<span class="token operator">-</span>plugin<span class="token operator">-</span>unit<span class="token operator">-</span>jest \n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="sion" tabindex="-1"><a class="header-anchor" href="#sion" aria-hidden="true">#</a> sion</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>https://sinonjs.org/releases/v9.2.4/spies/\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> sinon <span class="token keyword">from</span> <span class="token string">&#39;sinon&#39;</span>\n\n    <span class="token keyword">const</span> onall <span class="token operator">=</span> sinon<span class="token punctuation">.</span><span class="token function">stub</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">&#39;on-all&#39;</span><span class="token punctuation">,</span> onall<span class="token punctuation">)</span>\n    <span class="token function">expect</span><span class="token punctuation">(</span>onall<span class="token punctuation">.</span>called<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>https://sinonjs.org/releases/v9.2.4/spies/\nstub.called  \nstub.callCount \nstub.notCalled\nstub.calledTwice\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>www.tddjs.com</p><p>statement：语句覆盖率，顾名思义，有多少语句被测到。<br> branches：分支覆盖率，有多少逻辑分支被测到。<br> function：函数覆盖率，有多少个函数被测到。<br> lines：线路覆盖率，有多少个逻辑线路被测到。</p><h2 id="模拟http" tabindex="-1"><a class="header-anchor" href="#模拟http" aria-hidden="true">#</a> 模拟http</h2><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token number">1.</span>引入真实的请求方法所在的文件；<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> svc <span class="token keyword">from</span> <span class="token string">&#39;../../../../src/api/modules/common.js&#39;</span>\n\n<span class="token comment">// 使用jest.spyOn()创建一个mock函数</span>\n<span class="token keyword">const</span> HTTP_Upload <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">spyOn</span><span class="token punctuation">(</span>svc<span class="token punctuation">,</span> <span class="token string">&#39;HTTP_Upload&#39;</span><span class="token punctuation">)</span> \n\nHTTP_Upload<span class="token punctuation">.</span><span class="token function">mockReturnValueOnce</span><span class="token punctuation">(</span>\n    Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span> return_data<span class="token operator">:</span> <span class="token string">&#39;value&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h1 id="vue-test" tabindex="-1"><a class="header-anchor" href="#vue-test" aria-hidden="true">#</a> vue-test</h1><p>过滤属性</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> ZjmBidding <span class="token keyword">from</span> <span class="token string">&quot;./ZjmBidding.vue&quot;</span>\nZjmBidding<span class="token punctuation">.</span>filters<span class="token punctuation">.</span><span class="token function">timeFilters</span><span class="token punctuation">(</span><span class="token string">&#39;2021-02-10 12:12:12&#39;</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>计算属性</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> name <span class="token operator">=</span>  wrapper<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>fn\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h1 id="问题" tabindex="-1"><a class="header-anchor" href="#问题" aria-hidden="true">#</a> 问题</h1><p>引入外部报错问题</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>npm包\nbabel<span class="token operator">-</span>plugin<span class="token operator">-</span>transform<span class="token operator">-</span>require<span class="token operator">-</span>context\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>babel<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  plugins<span class="token operator">:</span> plugins<span class="token punctuation">,</span>\n  presets<span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token string">&#39;@vue/cli-plugin-babel/preset&#39;</span>\n  <span class="token punctuation">]</span><span class="token punctuation">,</span>\n<span class="token comment">// ++</span>\n  env<span class="token operator">:</span> <span class="token punctuation">{</span>\n    test<span class="token operator">:</span> <span class="token punctuation">{</span>\n      plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;transform-require-context&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// +</span>\n      presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&#39;@babel/preset-env&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> targets<span class="token operator">:</span> <span class="token punctuation">{</span> node<span class="token operator">:</span> <span class="token string">&#39;current&#39;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">]</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div>',23),p={},t=(0,a(3744).Z)(p,[["render",function(s,n){return e}]])},3744:(s,n)=>{n.Z=(s,n)=>{const a=s.__vccOpts||s;for(const[s,e]of n)a[s]=e;return a}}}]);