# 移动端

## 适配方案

### 1.rem

```
postcss-pxtorem: 是一款 PostCSS 插件，用于将 px 单位转化为 rem 单位；
lib-flexible: 用于设置 rem 基准值；


https://github.com/amfe/article/issues/17

1px
https://www.cnblogs.com/superlizhao/p/8729190.html
```

使用

```js
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">


// 首先是一个立即执行函数，执行时传入的参数是window和document
(function flexible (window, document) {
  var docEl = document.documentElement // 返回文档的root元素
  var dpr = window.devicePixelRatio || 1 
  // 获取设备的dpr，即当前设置下物理像素与虚拟像素的比值
 
  // 调整body标签的fontSize，fontSize = (12 * dpr) + 'px'
  // 设置默认字体大小，默认的字体大小继承自body
  function setBodyFontSize () {
    if (document.body) {
      document.body.style.fontSize = (12 * dpr) + 'px'
    } else {
      document.addEventListener('DOMContentLoaded', setBodyFontSize)
    }
  }
  setBodyFontSize();
 
  // set 1rem = viewWidth / 10
  // 设置root元素的fontSize = 其clientWidth / 10 + ‘px’
  function setRemUnit () {
    var rem = docEl.clientWidth / 10
    docEl.style.fontSize = rem + 'px'
  }
 
  setRemUnit()
 
  // 当页面展示或重新设置大小的时候，触发重新
  window.addEventListener('resize', setRemUnit)
  window.addEventListener('pageshow', function (e) {
    if (e.persisted) {
      setRemUnit()
    }
  })
 
  // 检测0.5px的支持，支持则root元素的class中有hairlines
  if (dpr >= 2) {
    var fakeBody = document.createElement('body')
    var testElement = document.createElement('div')
    testElement.style.border = '.5px solid transparent'
    fakeBody.appendChild(testElement)
    docEl.appendChild(fakeBody)
    if (testElement.offsetHeight === 1) {
      docEl.classList.add('hairlines')
    }
    docEl.removeChild(fakeBody)
  }
}(window, document));
```



## 2.viewport

```js
以vw、vh做为单位；

loader：
  https://github.com/evrone/postcss-px-to-viewport
```

## 单位

```
PX
px像素（Pixel）

em
相对父级文fontsize; 1em = 父fontsize;

rem
	相对html的fontsize大小; 1rem = html fontsize
	
vw
  100vw为屏幕宽度；
```

## vue监听键盘弹起

```js
常用于隐藏按钮

data(){
    return {
      showHeight: "",
      docmHeight: "",
      hidshow: true
    }
}  


mounted() {
    this.docmHeight = document.documentElement.clientHeight; //屏幕可视高度
    window.addEventListener("resize", () => {
      this.showHeight = document.documentElement.clientHeight; //变化可视高度
    });
  },
  watch: {
    showHeight() {
      if (this.showHeight < this.docmHeight) {
        // 弹起键盘
        this.hidshow = false;
      } else {
        this.hidshow = true;
      }
    }
  },
  destroyed() {
    window.onresize = null;
  },
```

ios input type="submit"

```css
ios会变成渐变圆弧按钮:''
解决: 加样式
outline: none;
-webkit-appearance: none;
```

vant picker插件适配

```js
不适配原因:行内样式 不转换 rem
 <van-picker show-toolbar
                    :columns="classNumList"
                    :item-height="pickerHeight"
                    @cancel="showPicker = false"
                    @confirm="onClassConfirm" />
                        
                        
 computed: {
    pickerHeight() {
      let height = 240;
      height = height * window.devicePixelRatio;
      let u = navigator.userAgent; // app = navigator.appVersion;
      let isAndroid = u.indexOf("Android") > -1 || u.indexOf("Linux") > -1; //g
      let isIOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端
      if (isAndroid) {
        return 220;
      }
      return height;
    }
  }
```

## 样式初始化

```css
/* 禁用iPhone中Safari的字号自动调整 */
html {
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
  /* 解决IOS默认滑动很卡的情况 */
  -webkit-overflow-scrolling: touch;
  /* user-select: none; */
  overflow-y: scroll;
}

/* 禁止缩放表单 */
input[type="submit"],
input[type="reset"],
input[type="button"],
input {
  resize: none;
  border: none;
}

/* 取消链接高亮  */
body,
div,
ul,
li,
ol,
h1,
h2,
h3,
h4,
h5,
h6,
input,
textarea,
select,
p,
dl,
dt,
dd,
a,
img,
button,
form,
table,
th,
tr,
td,
tbody,
article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
menu,
nav,
section {
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

/* 设置HTML5元素为块 */
article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
menu,
nav,
section {
  display: block;
}

/* 图片自适应 */
img {
  max-width: 100%;
  height: auto;
  width: auto\9; /* ie8 */
  display: block;
  -ms-interpolation-mode: bicubic; /*为了照顾ie图片缩放失真*/
  -webkit-touch-callout: none;
}

body {
  /* font: 12px/1.5 'Microsoft YaHei','宋体', Tahoma, Arial, sans-serif; */
  font-family: "PingFang SC", -apple-system, BlinkMacSystemFont,
    "Hiragino Sans GB", "Microsoft Yahei", sans-serif;
  user-select: none;
}
em,
i {
  font-style: normal;
}
ul,
li {
  list-style-type: none;
}
strong {
  font-weight: normal;
}
.clearfix:after {
  content: "";
  display: block;
  visibility: hidden;
  height: 0;
  clear: both;
}
.clearfix {
  zoom: 1;
}
a {
  text-decoration: none;
  color: #969696;
  font-family: "Microsoft YaHei", Tahoma, Arial, sans-serif;
}
a:hover {
  text-decoration: none;
}
ul,
ol {
  list-style: none;
}
h1,
h2,
h3,
h4,
h5,
h6 {
  font-size: 100%;
  font-family: "Microsoft YaHei";
}
img {
  border: none;
}
input {
  font-family: "Microsoft YaHei";
  outline: none;
  border: none;
  border: 1px solid #ccc;
}
/*单行溢出*/
.one-txt-cut {
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}
/*多行溢出 手机端使用*/
.txt-cut {
  overflow: hidden;
  text-overflow: ellipsis;
  display: -webkit-box;
  /* -webkit-line-clamp: 2; */
  -webkit-box-orient: vertical;
}
/* 移动端点击a链接出现蓝色背景问题解决 */
a:link,
a:active,
a:visited,
a:hover {
  background: none;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
  -webkit-tap-highlight-color: transparent;
}

// 移动端点击事件
.touchactive {
  &:active {
    opacity: 0.5;
  }
}

```

## 移动端300毫秒延迟问题

```js
import FastClick from "fastclick";
FastClick.attach(document.body);
```

