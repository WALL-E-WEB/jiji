# 小程序优化

## 分包

**小程序下包过程：**在小程序启动时，默认会下载主包并启动主包内页面，当用户进入分包内某个页面时，客户端会把对应分包下载下来，下载完成后再进行展示。

小程序划分成不同的子包，在构建时打包成不同的分包，用户在使用时按需进行加载。

对小程序进行分包，可以优化小程序首次启动的下载时间，

**主包：**即放置默认启动页面/TabBar 页面，以及一些所有分包都需用到公共资源/JS 脚本；

### 包限制

**目前小程序分包大小有以下限制：**

- 整个小程序所有分包大小不超过 20M
- 单个分包/主包大小不能超过 2M

### 引用规则

**分包引用规则：**

- `packageA` 无法 require `packageB` JS 文件，但可以 require 主包、`packageA` 内的 JS 文件；使用 [分包异步化](https://developers.weixin.qq.com/miniprogram/dev/framework/subpackages/async.html) 时不受此条限制

- `packageA` 无法 import `packageB` 的 template，但可以 require 主包、`packageA` 内的 template

- `packageA` 无法使用 `packageB` 的资源，但可以使用主包、`packageA` 内的资源

  

## **分包分类**

1. 普通分包：
   - 子包可以引用主包资源；
   - 进入子包或主包，都会下载主包；
2. 独立分包：
   - 子包不可以引用主包资源，完全独立；
   - 进入独立子包，不会下载主包；